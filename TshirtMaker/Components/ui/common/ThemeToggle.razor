@inject IJSRuntime JS
@implements IAsyncDisposable

<button class="btn btn-custom-secondary rounded-circle" @onclick="ToggleTheme" style="width: 40px; height: 40px; border: 1px solid var(--custom-primary-core);">
    @if (isDark)
    {
        <span>‚òÄÔ∏è</span>
    }
    else
    {
        <span>üåô</span>
    }
</button>

@code {
    private bool isDark = false;
    private DotNetObjectReference<ThemeToggle>? dotNetRef;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            dotNetRef = DotNetObjectReference.Create(this);
            var currentTheme = await JS.InvokeAsync<string>("themeToggle.getCurrentTheme");
            isDark = currentTheme == "dark";
            StateHasChanged();
        }
    }

    private async Task ToggleTheme()
    {
        await JS.InvokeVoidAsync("themeToggle.toggle");
        isDark = !isDark;
        StateHasChanged();
    }

    public ValueTask DisposeAsync()
    {
        dotNetRef?.Dispose();
        return ValueTask.CompletedTask;
    }
}
