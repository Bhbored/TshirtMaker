@using Microsoft.AspNetCore.Components.Authorization
@using TshirtMaker.Services

<div>
    @if (authService.CurrentUser != null)
    {
        @ChildContent
    }
    else
    {
        <div class="auth-guard-loading">
            <p>Checking authentication status...</p>
        </div>
    }
</div>

@code {
    [Parameter] public RenderFragment? ChildContent { get; set; }
    
    [Inject] public AuthStateService authService { get; set; } = default!;
    
    protected override async Task OnInitializedAsync()
    {
        // Ensure auth state is initialized
        await authService.InitializeAsync();
    }
}