@page "/signup"
@layout EmptyLayout
@using TshirtMaker.Services
@inject NavigationManager Navigation
@inject AuthService Auth

<div class="card card-custom p-4 shadow-lg fade-in" style="max-width: 450px; width: 100%;">
    <div class="text-center mb-4">
        <h2 class="fw-bold mb-2" style="background: linear-gradient(135deg, var(--custom-primary-core), var(--custom-accent-core)); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
            Create Account
        </h2>
        <p class="text-muted">Join us and start creating unique designs</p>
    </div>

    <form @onsubmit="HandleSignUp" @onsubmit:preventDefault="true">
        <div class="mb-3">
            <label class="form-label fw-semibold">Username</label>
            <input @bind="username" class="form-control input-custom py-2" placeholder="Choose a username" />
        </div>

        <div class="mb-3">
            <label class="form-label fw-semibold">Email</label>
            <input @bind="email" class="form-control input-custom py-2" placeholder="your@email.com" />
        </div>

        <div class="mb-3">
            <label class="form-label fw-semibold">Password</label>
            <input type="password" @bind="password" class="form-control input-custom py-2" placeholder="••••••••" />
        </div>

        @if (!string.IsNullOrEmpty(error))
        {
            <div class="alert alert-danger">@error</div>
        }

        <button type="submit" class="btn btn-custom-primary w-100 py-2 mb-3 fw-semibold">
            Create Account
        </button>
    </form>

    <div class="text-center">
        <p class="text-muted mb-0">Already have an account? <a href="/login" class="text-decoration-none" style="color: var(--custom-primary-core); font-weight: 600;">Sign In</a></p>
    </div>
</div>

@code {
    string username = "";
    string email = "";
    string password = "";
    string error = "";

    async Task HandleSignUp()
    {
        var user = await Auth.SignUp(email, username);

        if (user is null)
        {
            error = "Email already exists";
            return;
        }

        Navigation.NavigateTo("/dashboard");
    }
}
