@page "/login"
@layout EmptyLayout
@using TshirtMaker.Services
@inject NavigationManager Navigation
@inject AuthService Auth

<div class="card card-custom p-4 shadow-lg fade-in" style="max-width: 450px; width: 100%;">
    <div class="text-center mb-4">
        <h2 class="fw-bold mb-2" style="background: linear-gradient(135deg, var(--custom-primary-core), var(--custom-accent-core)); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
            Welcome Back
        </h2>
        <p class="text-muted">Sign in to continue creating amazing designs</p>
        <p class="small text-muted" style="opacity: 0.7;">Test users: design@test.com, artist@test.com, creative@test.com</p>
    </div>

    <form @onsubmit="HandleLogin" @onsubmit:preventDefault="true">
        <div class="mb-3">
            <label class="form-label fw-semibold">Email</label>
            <input @bind="email" class="form-control input-custom py-2" placeholder="your@email.com" />
        </div>

        <div class="mb-3">
            <label class="form-label fw-semibold">Password</label>
            <input type="password" @bind="password" class="form-control input-custom py-2" placeholder="••••••••" />
        </div>

        @if (!string.IsNullOrEmpty(error))
        {
            <div class="alert alert-danger">@error</div>
        }

        <button type="submit" class="btn btn-custom-primary w-100 py-2 mb-3 fw-semibold">Sign In</button>
    </form>

    <div class="text-center">
        <p class="text-muted mb-0">Don't have an account? <a href="/signup" class="text-decoration-none" style="color: var(--custom-primary-core); font-weight: 600;">Sign Up</a></p>
    </div>
</div>

@code {
    string email = "";
    string password = "";
    string error = "";

    async Task HandleLogin()
    {
        var user = await Auth.Login(email, password);

        if (user is null)
        {
            error = "Invalid credentials. Try: design@test.com, artist@test.com, creative@test.com, style@test.com, or trend@test.com";
            return;
        }

        Navigation.NavigateTo("/dashboard");
    }
}
